"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6573],{6573:function(e,r,t){t.d(r,{h:function(){return N}});var n=t(50029),a=t(76262),u=t.n(a),o=t(87794),c=t.n(o),s=t(35482),i=t(67294),p=t(59499),f=t(16835),l=t(72669),d=t.n(l),v=t(20926),w=t(98721);function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach((function(r){(0,p.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var m=function(){var e=(0,n.Z)(c().mark((function e(r){var t,n,a,u,o,s,i,p,l,d,v,h,m,O,g,R,x,y,E;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.client,n=r.userName,a=r.password,u=r.oauthCredential,o=r.isSignUp,s=void 0!==o&&o,e.next=3,k(n,a,u,s);case 3:return i=e.sent,p=i.user,l=i.providerId,d=p.uid,v=(0,f.Z)(p.providerData,1),h=v[0],m=h.email,O=h.displayName,e.next=8,p.getIdToken();case 8:return g=e.sent,e.next=11,p.getIdTokenResult();case 11:return R=e.sent.claims,e.next=14,t.query({query:w.en,errorPolicy:"ignore",context:{headers:{authorization:"Bearer ".concat(g)}}});case 14:return x=e.sent,y=x.data.me,E=b({uid:d,email:m||"",name:O||void 0,providerId:l,token:g,decodedToken:R},y&&{birdaUser:{id:y.id}}),e.abrupt("return",E);case 18:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),k=function(){var e=(0,n.Z)(c().mark((function e(r,t,n){var a,u=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.length>3&&void 0!==u[3]&&u[3],!r||!t){e.next=3;break}return e.abrupt("return",a?(0,s.Xb)(v.H,d()(r),t):(0,s.e5)(v.H,d()(r),t));case 3:if(!n){e.next=5;break}return e.abrupt("return",(0,s.sB)(v.H,n));case 5:throw new Error("Can't get user credential if no username and password or OAuth credential specified");case 6:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),O=function(){var e=(0,n.Z)(c().mark((function e(r,t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=4;break;case 4:return e.abrupt("return",(0,s.F6)(r,t));case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),g=function(){var e=(0,n.Z)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new s.hJ).addScope("email"),r.setCustomParameters({prompt:"select_account"}),e.abrupt("return",O(v.H,r));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,n.Z)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new s._O).setCustomParameters({auth_type:"rerequest"}),e.abrupt("return",O(v.H,r));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,n.Z)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new s.O4("apple.com"),e.abrupt("return",O(v.H,r));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=t(32013),E=t(66252),S=t(92876),_=function(e){var r=function(e){if(!e)return"UNKNOWN_ERROR";var r=String(e);return r.includes("auth/popup-closed-by-user")?"POPUP_CLOSED_BY_USER":r.includes("NETWORK_ERROR")||r.includes("network-request-failed")||r.includes("timeout")?"NETWORK_ERROR":r.includes("account-exists-with-different-credential")?"ACCOUNT_EXISTS_DIFFERENT_CREDENTIALS":r.includes("user-not-found")||r.includes("wrong-password")?"USERNAME_PASSWORD_INCORRECT":r.includes("auth/email-already-in-use")?"EMAIL_ALREADY_IN_USE":"UNKNOWN_ERROR"}(e);if("POPUP_CLOSED_BY_USER"===r)return"";"UNKNOWN_ERROR"===r&&S.Tb(e);var t=function(e){switch(e){case"NETWORK_ERROR":return"Sorry, we couldn't log you in. Please check your internet connection.";case"USERNAME_PASSWORD_INCORRECT":return"Your email or password is incorrect. Please double-check your information and try again. Or, if you signed up with an account provider like Google, please select the provider below.";case"ACCOUNT_EXISTS_DIFFERENT_CREDENTIALS":return"Sorry, we couldn't log you in because you signed up using a different account provider. Please choose a different option from the list below.";case"EMAIL_ALREADY_IN_USE":return"An account already exists for this email address. If it belongs to you, please log in or reset your password.";default:return"Sorry, something went wrong. Please try again later."}}(r);return t},N=function(){var e=(0,y.z)(),r=(0,E.x)(),t=(0,i.useState)(!0),a=t[0],o=t[1],p=(0,i.useState)(!1),f=p[0],l=p[1],d=(0,i.useState)(void 0),w=d[0],h=d[1],b=(0,i.useState)(""),k=b[0],O=b[1],g=(0,i.useCallback)((0,n.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.track("user:logout"),t.next=3,v.H.signOut();case 3:return t.next=5,r.clearStore();case 5:case"end":return t.stop()}}),t)}))),[r,e]),R=function(){var e=(0,n.Z)(c().mark((function e(t){var n,a,u,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.providerId){e.next=4;break}return e.abrupt("return");case 4:return a=C(n,t),e.next=7,m({oauthCredential:a,client:r});case 7:u=e.sent,h(u),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),o=_(e.t0),O(o);case 15:return e.prev=15,h(void 0),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(r){return e.apply(this,arguments)}}(),x=function(){var r=(0,n.Z)(c().mark((function r(t){return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,s.LS)(v.H,t);case 3:e.track("user:resetpassword:emailsent",{email:t}),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),e.track("user:resetpassword:invalidemail",{email:t,error:JSON.stringify(r.t0)});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})));return function(e){return r.apply(this,arguments)}}();return{login:function(t){l(!0),O(""),(0,n.Z)(c().mark((function n(){var a,o,s,i,p,f,d;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,a=t.userName,o=t.password,s=t.socialProvider,i=t.isSignUp,a&&o||s){n.next=4;break}return n.abrupt("return");case 4:if(!s){n.next=13;break}return n.next=7,P(s);case 7:if(p=n.sent){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,R(p);case 12:return n.abrupt("return");case 13:return n.next=15,m({userName:a,password:o,isSignUp:i,client:r});case 15:f=n.sent,e.track("user:login",u()(["token"],f)),h(f),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(0),d=_(n.t0),O(d);case 24:return n.prev=24,l(!1),h(void 0),n.finish(24);case 28:case"end":return n.stop()}}),n,null,[[0,20,24,28]])})))()},logout:g,checkForRedirectResult:function(){v.H.onAuthStateChanged((function(e){(0,n.Z)(c().mark((function r(){var t;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e||o(!1),r.next=3,(0,s.cx)(v.H);case 3:if(t=r.sent){r.next=7;break}return o(!1),r.abrupt("return");case 7:return r.next=9,R(t);case 9:case"end":return r.stop()}}),r)})))()}))},sendPasswordResetEmail:x,isLoading:a,isLoggingIn:f,loginError:k,loginResult:w}},P=function(){var e=(0,n.Z)(c().mark((function e(r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("google.com"!==r){e.next=2;break}return e.abrupt("return",g());case 2:if("facebook.com"!==r){e.next=4;break}return e.abrupt("return",R());case 4:if("apple.com"!==r){e.next=6;break}return e.abrupt("return",x());case 6:throw new Error("Unsupported social identity provider");case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),C=function(e,r){if("google.com"===e)return function(e){return s.hJ.credentialFromResult(e)||void 0}(r);if("facebook.com"===e)return function(e){return s._O.credentialFromResult(e)||void 0}(r);if("apple.com"===e)return function(e){return s.O4.credentialFromResult(e)||void 0}(r);throw new Error("Unsupported social identity provider")}}}]);